# Подглава 11.7 Архитектура MoveIt!

Детальное описание всего фреймворка MoveIt!, смотрите в концептуальном обзоре на MoveIt! вики. MoveIt! предоставляет как Python, так и C ++ API почти для всех аспектов управления движением, включая кинематику, совместное управление, планирование сцены и проверку столкновений, планирование движения и трехмерное восприятие.

API, который мы будем использовать в этой книге, — это интерфейс группы перемещения Python. _Группа перемещения_ описывает часть робота, которая представляет собой кинематическую цепь, представляющую собой серию links, соединенных joints, такими как pan-and-tilt head или рука. _Сцена планирования_ представляет собой абстракцию состояния мира, которая может контролировать размещение препятствий и состояние робота. Поэтому его можно использовать для проверки столкновений и оценки ограничений. Все действия по планированию должны ссылаться на заданную группу перемещений и осуществляться в рамках определенной сцены планирования.

Восприятие включает в себя использование данных датчиков, таких как лазерное сканирование и облака точек, для вставки обнаруженных объектов в сцену планирования, но мы также можем легко добавлять виртуальные объекты или игнорировать определенные виды данных датчиков. Это позволяет роботу планировать свои действия в виртуальной среде, которая может соответствовать или не соответствовать непосредственному состоянию окружающего мира. Во-первых, это означает, что мы можем протестировать все инструменты планирования, используя чисто смоделированного робота и набор виртуальных объектов. Это также означает, что мы можем запрограммировать робота так, чтобы он «представлял» сценарии планирования или сравнивал сохраненную сцену планирования со сценой, которая точно отражает текущее состояние мира перед ним.

К счастью для нас, MoveIt! включает помощника по настройке Setup Assistant, который позволяет легко настроить нашего робота для планирования движения. В частности, Setup Assistant позаботится о следующих задачах:

* URDF → SRDF: модель робота URDF используется для создания расширенного файла описания семантического робота, который содержит теги, определяющие группы движений, end-effectors и информацию о самоколлизиях. Файл SRDF создается автоматически из файла URDF при запуске MoveIt! Setup Assistant.
* Дополнительные файлы конфигурации также автоматически создаются Setup Assistant, и в этих файлах указываются кинематические solvers робота, joint-контроллеры и пределы joints, планировщики движения и датчики. Файлы конфигурации создаются в подкаталоге config в MoveIt! каталоге пакета данного робота. Файлы, которые нас больше всего интересуют — `kinematics.yaml, controllers.yaml, joint_limits.yaml и sensor_rgbd.yaml`, — будут подробно описаны ниже в этой главе.
* Setup Assistant также создает ряд файлов запуска для запуска ключевых модулей планирования и управления движением, включая:
  * конвейер сцены планирования, включающий проверку столкновений и сетку занятости с использованием Octomap
  * планирование движения с использованием OMPL \(Open Motion Planning Library\)
  *  узел `move_group`, который предоставляет топики, сервисы и действия, используемые для кинематики, планирования и выполнения, `pick-and-place`, проверки состояния и планирования запросов и обновлений сценыJTAC для запуска соответствующих контроллеров траектории для данного робота

Два ключевых элемента не создаются в MoveIt! Setup Assistant — это файлы конфигурации и файлы запуска для конкретного контроллера вашего робота. Поэтому мы подробно рассмотрим эту задачу позже в этой главе.

