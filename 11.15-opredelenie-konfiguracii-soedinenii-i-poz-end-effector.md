# Подглава 11.15 Определение конфигураций соединений и поз end-effector

Позже в этой главе мы напишем наши собственные узлы Python, чтобы установить целевые конфигурации для руки или целевой позы end-effector. Для конфигурации целей нам нужно знать желаемые углы joints, а для поз end-effector нам нужно знать целевое положение и ориентацию end-effector \(например, gripper\). Эти значения не всегда легко угадать или визуализировать, поэтому нам нужен метод для более точного их получения.

Одним из вариантов является использование MoveIt! в демонстрационном режиме вместе с интерфейсом командной строки. Используя интерактивные маркеры в RViz, расположите руку или end-effector так, как вы хотите, затем считайте полученные углы соединения или позу end-effector, используя команду `current` в MoveIt! интерфейсе командной строки, как мы делали ранее.

Например, предположим, что мы установили руку с помощью интерактивных маркеров в RViz, как показано ниже, и мы хотим получить либо углы joints, либо позу end-effector, чтобы мы могли использовать ее позже в качестве цели в одной из наших программ.

![](.gitbook/assets/image%20%2819%29.png)

Просто откройте MoveIt! интерфейс командной строки, выберите группу перемещения `right_arm` и введите команду `current` следующим образом:

```text
$ rosrun moveit_commander moveit_commander_cmdline.py
> use right_arm
right_arm> current
```

Вывод должен выглядеть следующим образом:

```text
joints = [-0.395309951307 -1.03650332222 -2.40611416266 1.22550181669 -1.11578483203 0.829686311888]
right_gripper_link pose =
[ header: seq: 0 stamp:
secs: 1401584103 nsecs:
673882961 frame_id: /odom
pose: position: x:
0.130429148535 y: -
0.211274182496 z:
0.849751498818 orientation:
x: 0.688193773223
y: 0.000192406815258
z: -0.000249462081726
w: 0.725526864592 ]
right_gripper_link RPY = [1.517993195677934, 0.0006225491696134483, -9.715655858643511e-05]
```

Углы joints расположены в том порядке, в котором они появляются в кинематической цепи, начиная с плечевого joint, и поза относится к позе end-effector относительно frame `/odom`. \(Это также работает для frame `/base_footprint` из-за planar виртуального joint, который мы определили, соединяя frame `/odom` и frame `/base_footprint` в MoveIt! Setup Assistant\). Эти числа могут быть скопированы в ваш скрипт и использованы в качестве целевых углов joints или целевой позы для end-effector.

Вы также можете определить позу end-effector непосредственно в RViz, развернув дерево **Links** под **Scene Robot**, а затем развернув link `right_gripper`, чтобы показать его текущее положение и ориентацию. Тем не менее, использование вышеописанной методики дает как углы joints, так и позу end-effector, и не требует всех этих кликаний в RViz.

Наконец, вы можете использовать удобный скрипт `get_arm_pose.py`, который находится в каталоге `rbx2_arm_nav/scripts`. Скрипт использует MoveIt! API, поэтому файл робота `move_group.launch` уже должен быть запущен. Запустите скрипт с помощью команды:

```text
$ rosrun rbx2_arm_nav get_arm_pose.py
```

Вывод включает в себя список активных joints и их текущее положение, а также положение end-effector. Эти значения представлены в формате, который позволяет копировать и вставлять их в сценарий, который будет использоваться в качестве целевых значений.

